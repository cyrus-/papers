2
\linenumber{1}
  \newcommand{\linenumber}[1]{{\tt{\color{gray} #1}}}
\keyw{type}~\svar{V} = \scolor{\concty{lprod}{\{\conclbl{venue} : \concty{rstr}{\concrx{([A-Z]+) \digit\{4\}}}\}}}
\linenumber{2}
\keyw{let}~{v} : \scolor{\svar{V}} = {\{\conclbl{venue}}{=}\concstr{EXMPL 2015}\}
  \newcommand{\concty}[2]{\fvar{#1}~#2}
  \newcommand{\concrx}[1]{\texttt{\scriptsize /#1/}}
  \newcommand{\concstr}[1]{\texttt{\scriptsize "#1"}}
  \newcommand{\conctarg}[1]{.\opname{#1}}
  \newcommand{\conclbl}[1]{\texttt{\scriptsize #1}}
\linenumber{3}
\keyw{let}~prefix = \concstr{01.0001/} : \scolor{\concty{rstr}{\concrx{\digit\{2\}\rdot\digit\{4\}\textbackslash/}}}
  \newcommand{\digit}{\textbackslash d}
  \newcommand{\rdot}{\textbackslash .}
\linenumber{4}
\keyw{fun}~paper~(title : \scolor{\concty{rstr}{\concrx{.+}}})~(id : \scolor{\concty{rstr}{\concrx{\digit+}}}) = 
\linenumber{5}
\quad v\conctarg{with}(\conclbl{title} = title, \conclbl{doi} = prefix\conctarg{concat}(id))
%\linenumber{6}
%\quad\quad \conclbl{doi} = doi\_prefix\conctarg{cat}(id))
\linenumber{6}
\keyw{let}~pid : \scolor{\concty{rstr}{\concrx{\digit\{3\}}}} = \concstr{005}
\linenumber{7}
\keyw{let}~p = paper~\concstr{M Theory}~(pid\conctarg{coerce}[\scolor{\concrx{\digit+}}])
\linenumber{8}
\keyw{let}~{c} = p\opname{\#}\conclbl{venue}\opname{\#}0
\linenumber{9}
c\conctarg{case}(\lambda c:\scolor{\concty{rstr}{\concrx{EXMPL}}}.c.\opname{!rc}; v.\opname{!ri})
